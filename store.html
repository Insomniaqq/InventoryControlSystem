<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="favicons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="favicons/favicon.svg">
    <link rel="shortcut icon" href="favicons/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon.png">
    <link rel="manifest" href="favicons/site.webmanifest">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100..900&display=swap" rel="stylesheet">
    <title>Склад</title>
    <link rel="stylesheet" href="css/store.css">
    <script defer src="js/main.js"></script>
    <script defer src="js/store.js"></script>
</head>

<body>
    <div class="container">
        <aside class="menu">
            <div class="menu__user">
                <div class="avatar">
                    <img class="menu__avatar" src="img/avatar.svg" alt="avatar">
                    <p class="user_id">Закупщик</p>
                </div>
                <a href="index.html" id="logoutButton">
                    <img class="logout__img" src="img/log-out.svg" alt="logout">
                </a>
            </div>

            <h2 class="menu__title">Панель управления</h2>
            <ul class="nav__menu">
                <li>
                    <a href="store.html"><img src="img/clipboard-list.svg" alt="clipboard"> Склад</a>
                </li>
                <li>
                    <a href="buy.html"><img src="img/shopping-cart.svg" alt="cart"> Закупки</a>
                </li>
                <li>
                    <a href="suppliers.html"><img src="img/user.svg" alt="user"> Поставщики</a>
                </li>
                <li>
                    <a href="active-orders.html"><img src="img/active.svg" alt="active"> Текущие заказы</a>
                </li>
                <li>
                    <a class="admin" href="admin.html"><img class="admin-img" src="img/user-list.svg" alt="admin">
                        Администратор</a>
                </li>
            </ul>

        </aside>
    </div>
    <main class="main__container">
        <h1 class="main__title">Склад</h1>
        <h2 class="main__title2">Остатки товара</h2>
        <button class="add-button" id="addButton">Добавить товар</button>
        <form class="search-container">
            <input type="search" id="searchInput" placeholder="Поиск по складу...">
        </form>
        <table class="table" id="inventoryTable">
            <thead>
                <tr>
                    <th>Категория</th>
                    <th>Наименование</th>
                    <th>Кол-во</th>
                    <th>ID Товара</th>
                    <th></th>
                </tr>
            </thead>
            <tbody id="inventoryBody">

            </tbody>
        </table>

        <div class="form-container" id="formContainer-store" style="display: none;">
            <div class="form-container__content store">
                <div class="form-header">
                    <h2>Форма заполнения</h2>
                    <button class="close-button">✖</button>
                </div>

                <form id="productForm">
                    <div class="first">
                        <div class="category">
                            <label>КАТЕГОРИЯ</label>
                            <select id="categorySelect" required>

                            </select>
                        </div>
                        <div class="name">
                            <label>НАИМЕНОВАНИЕ</label>
                            <select id="nameSelect" required>

                            </select>
                        </div>
                        <div class="man">
                            <label>ПОСТАВЩИК</label>
                            <select id="supplierSelect" required>

                            </select>
                        </div>
                    </div>

                    <div class="second">
                        <div class="amount">
                            <label>КОЛИЧЕСТВО</label>
                            <input type="number" id="quantityInput" placeholder="" required>
                            <select id="unitSelect" required>
                                <option value="кг">кг</option>
                                <option value="шт">шт</option>
                                <option value="л">л</option>
                            </select>
                        </div>
                    </div>
                    <div id="errorContainer" style="color: red; margin: 10px 0;"></div>
                    <div id="errorContainer" style="color: rgb(126, 4, 4); margin: 10px 0;"></div>
                    <button type="submit" class="submit-button">Добавить</button>
                </form>
            </div>
        </div>
        <div class="form-container" id="editFormContainer" style="display: none;">
            <div class="form-container__content store">
                <div class="form-header">
                    <h2>Редактирование товара</h2>
                    <button class="close-button" id="closeEditButton">✖</button>
                </div>

                <form id="editProductForm">
                    <div class="amount">
                        <label>КОЛИЧЕСТВО</label>
                        <input type="number" id="editQuantityInput" placeholder="">
                        <label>ЕД.ИЗМЕРЕНИЯ</label>
                        <select id="editUnitSelect">
                            <option value="кг">кг</option>
                            <option value="шт">шт</option>
                            <option value="л">л</option>
                        </select>
                    </div>
                    <div id="errorContainer" style="color: red; margin: 10px 0;"></div>
                    <div id="editErrorContainer" style="color: rgb(126, 4, 4); margin: 10px 0;"></div>
                    <button type="submit" class="submit-button">Сохранить изменения</button>
                </form>
            </div>
        </div>
    </main>

    <script>

        const currentUser = JSON.parse(localStorage.getItem("currentUser"));

        if (!currentUser || currentUser.role !== "Закупщик" && currentUser.role !== "Администратор") {
            window.location.href = "index.html";
        }
    </script>
</body>

</html>